Code for Emily's thesis
